<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Practice Zone | Maths Skills Hub</title>
  <link rel="stylesheet" href="styles.css" />
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)'], ['$', '$']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <style>
    .practice-head { display:flex; justify-content:space-between; align-items:flex-start; gap:.75rem; flex-wrap:wrap; }
    .meta-note { color: var(--muted); font-size:.9rem; margin:.3rem 0 .2rem; }
    .actions { display:flex; gap:.45rem; flex-wrap:wrap; }
    .btn-lite {
      border:1px solid var(--border); background:#f7f0e6; color:#5f4a32; padding:.35rem .65rem;
      border-radius:.55rem; font-weight:700; cursor:pointer;
    }
    .btn-lite:hover { background:#efe4d4; }
    .btn-lite:focus-visible { outline: 2px solid var(--accent2); outline-offset: 2px; }
  </style>
</head>
<body>
  <header class="site-header"><div class="wrap"><h1>Practice Zone</h1><nav><a href="index.html">Home</a><a href="lower-school-sow.html">IGCSE</a><a href="alevel.html">A-Level Skills</a><a class="active" href="practice.html">Practice Zone</a></nav></div></header>
  <main class="wrap">
    <section class="grid two">
      <article class="card" id="igcse-card">
        <div class="practice-head">
          <h2>IGCSE Drill (5 mins)</h2>
          <div class="actions"><button class="btn-lite" type="button" id="igcse-refresh">↻ New set</button></div>
        </div>
        <p class="meta-note" id="igcse-meta"></p>
        <ol id="igcse-questions"></ol>
      </article>
      <article class="card" id="alevel-card">
        <div class="practice-head">
          <h2>A-Level Drill (7 mins)</h2>
          <div class="actions"><button class="btn-lite" type="button" id="alevel-refresh">↻ New set</button></div>
        </div>
        <p class="meta-note" id="alevel-meta"></p>
        <ol id="alevel-questions"></ol>
      </article>
    </section>
    <section class="card">
      <h3>Answer Check (no peeking until done)</h3>
      <details>
        <summary>Show answers</summary>
        <p id="answers-box"></p>
      </details>
    </section>
  </main>

  <script>
    const todayKey = new Date().toISOString().slice(0,10); // day-based rotation

    function hash(str){
      let h = 2166136261;
      for (let i=0;i<str.length;i++) {
        h ^= str.charCodeAt(i);
        h = Math.imul(h, 16777619);
      }
      return h >>> 0;
    }

    function mulberry32(a){
      return function(){
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      }
    }

    function choose(rng, arr){ return arr[Math.floor(rng()*arr.length)] }

    function linearQ(rng){
      const a = Math.floor(rng()*8)+2;
      const x = Math.floor(rng()*12)-3;
      const b = Math.floor(rng()*17)-8;
      const c = a*x + b;
      return { q:`Solve: \\(${a}x ${b>=0?'+':''}${b} = ${c}\\)`, a:`\\(x=${x}\\)` };
    }

    function expandQ(rng){
      const p = Math.floor(rng()*8)-3;
      const q = Math.floor(rng()*9)-4;
      const r = Math.floor(rng()*7)-2;
      const s = Math.floor(rng()*8)-3;
      const A = p*r, B = p*s + q*r, C = q*s;
      return {
        q:`Expand: \\((${p===1?'':p===-1?'-':p}x ${q>=0?'+':''}${q})(${r===1?'':r===-1?'-':r}x ${s>=0?'+':''}${s})\\)`,
        a:`\\(${A===1?'':A===-1?'-':A}x^2 ${B>=0?'+':''}${B}x ${C>=0?'+':''}${C}\\)`
      };
    }

    function circleAreaQ(rng){
      const r = Math.floor(rng()*9)+2;
      return { q:`Area of circle radius ${r} (leave in \\(\\pi\\))`, a:`\\(${r*r}\\pi\\)` };
    }

    function diffQ(rng){
      const a = Math.floor(rng()*5)+1;
      const b = Math.floor(rng()*7)-3;
      const c = Math.floor(rng()*9)-4;
      return {
        q:`Differentiate: \\(y=${a}x^3 ${b>=0?'+':''}${b}x ${c>=0?'+':''}${c}\\)`,
        a:`\\(\\dfrac{dy}{dx}=${3*a}x^2 ${b>=0?'+':''}${b}\\)`
      };
    }

    function integrateQ(rng){
      const a = (Math.floor(rng()*6)+1)*2;
      const b = Math.floor(rng()*7)-3;
      const A = a/3;
      return {
        q:`Integrate: \\(\\int(${a}x^2 ${b>=0?'+':''}${b})\\,dx\\)`,
        a:`\\(${A}x^3 ${b>=0?'+':''}${b}x + C\\)`
      };
    }

    function trigQ(rng){
      const opts = [
        {q:'Solve: \\(2\\sin x = 1\\), \\(0^\\circ \\le x \\le 360^\\circ\\)', a:'\\(x=30^\\circ,150^\\circ\\)'},
        {q:'Solve: \\(\\cos x = -\\frac{1}{2}\\), \\(0^\\circ \\le x \\le 360^\\circ\\)', a:'\\(x=120^\\circ,240^\\circ\\)'},
        {q:'Solve: \\(\\tan x = 1\\), \\(0^\\circ \\le x \\le 360^\\circ\\)', a:'\\(x=45^\\circ,225^\\circ\\)'}
      ];
      return choose(rng, opts);
    }

    const igcseTypes = [linearQ, expandQ, circleAreaQ];
    const alevelTypes = [diffQ, integrateQ, trigQ];

    const state = {
      igcseNonce: 0,
      alevelNonce: 0
    };

    function renderSet(stream){
      const isIGCSE = stream === 'igcse';
      const nonce = isIGCSE ? state.igcseNonce : state.alevelNonce;
      const seed = hash(`${todayKey}:${stream}:${nonce}`);
      const rng = mulberry32(seed);
      const generators = isIGCSE ? igcseTypes : alevelTypes;
      const out = generators.map(g => g(rng));

      const qEl = document.getElementById(`${stream}-questions`);
      const metaEl = document.getElementById(`${stream}-meta`);
      qEl.innerHTML = out.map(item => `<li>${item.q}</li>`).join('');
      metaEl.textContent = `Daily seed: ${todayKey} · variant ${nonce+1}${nonce===0?' (stable daily set)':' (manual refresh)'}`;

      return out;
    }

    function renderAll(){
      const i = renderSet('igcse');
      const a = renderSet('alevel');
      document.getElementById('answers-box').innerHTML =
        `<strong>IGCSE:</strong> 1) ${i[0].a} 2) ${i[1].a} 3) ${i[2].a}<br/>`+
        `<strong>A-Level:</strong> 1) ${a[0].a} 2) ${a[1].a} 3) ${a[2].a}`;

      if (window.MathJax?.typesetPromise) {
        window.MathJax.typesetPromise().catch(() => {});
      }
    }

    document.getElementById('igcse-refresh').addEventListener('click', () => {
      state.igcseNonce++;
      renderAll();
    });

    document.getElementById('alevel-refresh').addEventListener('click', () => {
      state.alevelNonce++;
      renderAll();
    });

    renderAll();
  </script>
</body>
</html>
